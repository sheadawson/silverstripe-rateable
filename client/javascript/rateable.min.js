!function(){"use strict";var e;e=function(){var e=document.querySelector(".rateable-ui");if(void 0!==e&&null!=e){var t=e.querySelectorAll("button");Array.prototype.forEach.call(t,function(n,i){n.addEventListener("mouseenter",function(e){a(e.target).forEach(function(e){e.classList.add("is-hover")}),e.target.classList.add("is-hover")},!1),n.addEventListener("mouseleave",function(e){a(e.target).forEach(function(e){e.classList.remove("is-hover")}),e.target.classList.remove("is-hover")},!1),n.addEventListener("focus",function(e){a(e.target).forEach(function(e){e.classList.add("is-focused")}),e.target.classList.add("is-focused")},!1),n.addEventListener("blur",function(e){a(e.target).forEach(function(e){e.classList.remove("is-focused")}),e.target.classList.remove("is-focused")},!1),n.addEventListener("click",function(n){if(n.preventDefault(),!e.classList.contains("is-waiting-on-ajax")){e.classList.add("is-waiting-on-ajax");var i=this,r=i.value,o=new XMLHttpRequest;o.open("GET",e.getAttribute("data-ratepath")+"?score="+r,!0),o.onload=function(){if(this.status>=200&&this.status<400){var n=JSON.parse(this.response);if("error"!=n.status){if(void 0!==n.isremovingrating&&1==n.isremovingrating){n.isremovingrating=1;var r=r(i);r.forEach(function(e){e.classList.remove("has-voted")}),i.classList.remove("has-voted"),e.classList.remove("has-voted")}else{n.isremovingrating=0,function(e){for(var t=[];e=e.nextElementSibling;)t.push(e);return t}(i).forEach(function(e){e.classList.remove("has-voted")}),a(i).forEach(function(e){e.classList.add("has-voted")}),i.classList.add("has-voted"),e.classList.add("has-voted")}t.length>1?Array.prototype.forEach.call(t,function(e,t){e.value<=n.averagescore?e.classList.add("is-average-score"):e.classList.remove("is-average-score")}):Array.prototype.forEach.call(t,function(e,t){e.classList.remove("is-average-score")});var o=document.querySelector(".js-rateable-numberofratings");void 0!==o&&null!=o&&(o.innerHTML=n.numberofratings),s(n.message),e.dispatchEvent(new CustomEvent("ratingChange",i.response)),e.classList.remove("is-waiting-on-ajax"),e.dispatchEvent(new CustomEvent("ratingFinished",i.response))}else s(n.message)}else s(this.statusText)},o.onerror=function(){e.innerHTML=i.statusText,e.dispatchEvent(new CustomEvent("ratingError",i.response)),e.classList.remove("is-waiting-on-ajax"),e.dispatchEvent(new CustomEvent("ratingFinished",i.response))},o.send()}},!1)}),e.dispatchEvent(new CustomEvent("ratingInit"))}function s(t){t&&0==e.getAttribute("data-disablealert")&&alert(t)}function a(e){for(var t=[];e=e.previousElementSibling;)t.push(e);return t}},(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}();